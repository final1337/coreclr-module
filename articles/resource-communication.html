<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Resource communication </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Resource communication ">
    <meta name="generator" content="docfx 2.48.1.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="resource-communication">Resource communication</h1>

<p>This article will describe how to communicate between different server resources.</p>
<h2 id="exports">Exports</h2>
<p>Resources can define data that other resources can access while the resource is starting. This data is immutable after resource finished starting and can be accessed from any serverside resource.</p>
<pre><code class="lang-csharp">public class SampleResource : AsyncResource
{
  public override void OnStart()
  {
    var value = &quot;test&quot;;
    Alt.Export(&quot;myDataKey&quot;, value);
  }
}
</code></pre>
<p>You can export any data you can also send via events. Including: <code>object</code>, <code>bool</code>, <code>int</code>, <code>long</code>, <code>uint</code>, <code>ulong</code>, <code>float</code>, <code>double</code>, <code>string</code>, <code>IPlayer</code> (or any types extending IPlayer), <code>IVehicle</code> (or any types extending IVehicle), <code>Dictionary&lt;string, (any type listed here)</code>, <code>Alt.Function</code>, any type listed here as array e.g. int[].
Also any dictionary in dictionary, array in array, ect. endless depth types are supported, because they are resolved recursively.</p>
<h3 id="export-functions">Export functions</h3>
<p>Functions are also possible to export. Supported function parameters are same types supported by events and exports.</p>
<pre><code class="lang-csharp">public class SampleResource : AsyncResource
{
  public override void OnStart()
  {
    Alt.Export(&quot;myFunction&quot;, new Action&lt;int&gt;(Myfunc));
    
    Alt.Export(&quot;myFunction2&quot;, new Func&lt;int, bool&gt;(Myfunc2));
  }
  
  public void Myfunc(int myInt)
  {
            
  }
  
  public bool Myfunc2(int myInt)
  {
            
  }
}
</code></pre>
<h2 id="imports">Imports</h2>
<p>Resources can import data that got exported from other resources. Most likely you will define the resource where you import from as <code>deps: [ myResource, myResource2 ]</code> in your <code>resource.cfg</code> to make sure the resource is already started when your resource starts.
You also have to define the resource name where you import data from.</p>
<pre><code class="lang-csharp">public class SampleResource : AsyncResource
{
  public override void OnStart()
  {
    Alt.Import(&quot;myResourceToImportFrom&quot;, &quot;myFunction&quot;, out Action&lt;int&gt; myFunction);
    
    myFunction(13);
  }
}
</code></pre>
<p>This works the same with functions that return data. The return type is always the last generic type in <code>Func&lt;...&gt;</code>.</p>
<pre><code class="lang-csharp">public class SampleResource : AsyncResource
{
  public override void OnStart()
  {
    Alt.Import(&quot;myResourceToImportFrom&quot;, &quot;myFunction2&quot;, out Func&lt;int, bool&gt; myFunction);
    
    Console.WriteLine(myFunction(13));
  }
}
</code></pre>
<h2 id="events">Events</h2>
<p>Another way to communicate with resources is by sending events to them. The <code>Alt.Emit(&quot;eventName&quot;, values)</code> works same as player events and supports all data types that are supported by exports.
Every resource will get notified about the event. You can listen explicit for server events via <code>Alt.OnServer(&quot;eventName&quot;, OnServerEvent)</code>.
The server event delegate needs to have to following signature.</p>
<pre><code class="lang-csharp">public void OnServerEvent(object[] args)
{
}
</code></pre>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/FabianTerhorst/coreclr-module/blob/9d8495b7af0e8ef9f671eefeabcfa817b5a02ff1/docs/articles/resource-communication.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
